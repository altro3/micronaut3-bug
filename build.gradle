plugins {
    id 'java'
    id 'idea'
    id 'io.micronaut.application' version '3.2.0'
}

mainClassName = "com.micronaut.bug.Application"
micronaut {
    version '3.3.0'
    runtime "netty"
    testRuntime "junit5"
    enableNativeImage true
    processing {
        group project.group
        incremental true
        annotations "com.micronaut.bug.*"
    }
}

wrapper.gradleVersion = '7.3.3'

java {
    sourceCompatibility = JavaVersion.VERSION_17
}

dependencies {

    annotationProcessor "org.projectlombok:lombok"
    annotationProcessor "io.micronaut:micronaut-inject-java"

    compileOnly "org.projectlombok:lombok"
    compileOnly "io.micronaut:micronaut-inject-java"

    runtimeOnly "ch.qos.logback:logback-classic"

    implementation "io.micronaut:micronaut-runtime"

    // micronaut-data
    annotationProcessor "io.micronaut.data:micronaut-data-processor"
    runtimeOnly "io.micronaut.sql:micronaut-jdbc-hikari"
    runtimeOnly "org.postgresql:postgresql"
    implementation "io.micronaut.data:micronaut-data-jdbc"
    runtimeOnly "io.micronaut.flyway:micronaut-flyway"

}

tasks.withType(JavaCompile).all {
    options.encoding = 'UTF-8'
    options.compilerArgs = [
            '-parameters',
            '-Xlint:unchecked',
            '-Xlint:deprecation'
    ]
}

idea {

    module {
        excludeDirs += file('.idea')
        excludeDirs += file('out')
    }
}
